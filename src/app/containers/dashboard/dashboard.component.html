<div (window:resize)="onResize($event)"
  *ngIf="!isLoading" [class.minimize-main-nav]="uiFlag.sidebarMode === 'expand'"
  style="display: flex;align-items: stretch;"
>
  <ng-container *ngIf="!isPreviewMode">
    <header class="header header__color ala-dashboard-header">
      <div class="mobile-menu-toggle" (click)="navbarFixed()" *ngIf="uiFlag.mobileMode">
        <div>
          <i class="icon-svg_web-icon_p1_005-menu main-nav-toggle-icon"></i>
        </div>
      </div>
      <div style="display: flex; position: fixed; right: 20px">
        <div class="dropdown">
          <div class="header-nav-item" id="dropdownMenu3" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            <div class="header-nav-item" style="margin-right: 10px">
              {{ userProfile.nickname || '' }}
            </div>
            <img
              [src]="userProfile.avatarUrl"
              class="header-user-photo"
              (error)="this.userProfile.avatarUrl='/assets/images/user2.png'"
            >
            <i
              class="icon-svg_web-icon_p1_069-about"
              style="color: #ff3838; font-size: 30px; position: absolute; right: -15px; bottom: 0px;"
              *ngIf="accountStatus === 1"
            ></i>
          </div>
          <div class="dropdown-menu dropdown-user-menu" [class.show]="isUserMenuShow"
             aria-labelledby="dropdownMenu3"
          >
            <div class="header-nav-menu-section">
              <!-- <div (click)="$event.preventDefault();$event.stopPropagation();"
                style="padding: 15px 20px"
              >
                {{ userName || '' }}
              </div> -->
            </div>
            <div class="header-nav-menu-section">
              <ul>
                <li style="color: #ff3838; font-weight: bold;" [routerLink]="['/enableAccount-web']" *ngIf="accountStatus === 1">
                  {{ "universal_deviceSetting_switch" | translate}} {{ "universal_userAccount_account" | translate}}
                </li>
                <li (click)="goToUserProfile(userProfile.userId)">
                  {{ "universal_userProfile_info" | translate}}
                </li>
                <li [routerLink]="['/dashboard/settings']">
                  {{ "universal_system_accountManagement" | translate}}
                </li>
              </ul>
            </div>
            <button class="dropdown-item" type="button" (click)="logout()">{{ "universal_userAccount_logOut" | translate}}</button>
          </div>
        </div>
      </div>
    </header>

    <nav
      class="flexCol expand__navbar"
      [class.narrow__navbar]="uiFlag.sidebarMode === 'narrow' && !uiFlag.navFixed"
      [class.hide__navbar]="uiFlag.sidebarMode === 'hide' && !uiFlag.navFixed"
      [class.cover__mode]="uiFlag.mobileMode"
      (mouseenter)="expandSidebar()"
      (mouseleave)="shrinkSidebar()"
    >
      <div
        class="flexRow ala-dashboard-logo nav__color"
        style="font-family: Eurostile-ExtendedTwo; font-size: 22px; height: 30px; justify-content: space-between;"
      >
        <span
          style="cursor: pointer;"
          class="navbar__list__title"
          [style.display]="uiFlag.sidebarMode !== 'expand' && !uiFlag.navFixed ? 'none' : flex"
          (click)="navigateHomePage()"
        >
          GPTFit
          <span class="alpha-text" *ngIf="isAlphaVersion">alpha</span>
        </span>
        <div
          class="toggle__btn"
          [class.toggle__btn__move]="uiFlag.sidebarMode === 'narrow' && !uiFlag.navFixed ? false : true"
          (click)="navbarFixed()"
          *ngIf="!uiFlag.mobileMode"
        >
          <div
            class="main-nav-toggle"
            style="position: relative; left: -3px;"
            *ngIf="uiFlag.sidebarMode === 'expand' || uiFlag.fixed"
          >
            <i class="icon-svg_web-icon_p3_071-pin pin__icon" *ngIf="uiFlag.navFixed === true"></i>
            <i
              class="icon-svg_web-icon_p3_070-unpin pin__icon"
              *ngIf="uiFlag.navFixed === false"
            ></i>
          </div>
        </div>
      </div>
      <div class="flexCol" style="justify-content: space-between; height: 90vh; overflow-y: scroll; scrollbar-width: none;">
        <main>
          <section style="margin-bottom: 30px;">
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'timelyActivity' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('timelyActivity')">
                <i
                  class="icon-svg_web-icon_p1_003-peoples ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && target === 3"
                ></i>
                <span
                  class="small__side navbar__list__title"
                  [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed"
                >
                  <span>{{"universal_activityData_timelyActivity" | translate}}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'timelyActivity'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'timelyActivity' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(3)"
                  [class.ala-sidenav-menu-item__active]="target === 3"
                  [routerLink]="['/dashboard/live/train-live']"
                >
                  Train live
                </li>
              </div>
            </div>
            <div 
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'group' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('group')">
                <i
                  class="icon-svg_web-icon_p1_036-friends ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 10 || target === 17)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span>{{"universal_group_group" | translate}}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'group'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'group' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(10)"
                  [class.ala-sidenav-menu-item__active]="target === 10"
                  [routerLink]="['/dashboard/my-group-list']"
                >
                  {{"universal_group_myGroup" | translate}}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(17)"
                  [class.ala-sidenav-menu-item__active]="target === 17"
                  [routerLink]="['/dashboard/group-search']"
                >
                  {{"universal_group_searchGroup" | translate}}
                </li>
              </div>
            </div>
            <div class="nav__color" *ngIf="uiFlag.sidebarMode !== 'hide'">
              <li class="ala-sidenav-item drop__down"
                (click)="chooseItem(14)"
                [class.ala-sidenav-menu-item__active]="target === 14"
                [routerLink]="['/dashboard/activity-list']"
              >
                <i
                  class="icon-svg_web-icon_p1_083-run ala-sidenav-icon"
                ></i>
                <span class="navbar__list__title" [style.display]="uiFlag.sidebarMode !== 'expand' && !uiFlag.navFixed ? 'none' : flex">
                  {{"universal_activityData_myActivities" | translate}}
                </span>
              </li>
            </div>
            <div class="nav__color" *ngIf="uiFlag.sidebarMode !== 'hide'">
              <li class="ala-sidenav-item drop__down"
                (click)="chooseItem(15)"
                [class.ala-sidenav-menu-item__active]="target === 15"
                [routerLink]="['/dashboard/device']"
              >
                <i class="icon-svg_web-icon_p1_010-treadmill ala-sidenav-icon"></i>
                <span class="navbar__list__title" [style.display]="uiFlag.sidebarMode !== 'expand' && !uiFlag.navFixed ? 'none' : flex">
                  {{"universal_deviceSetting_myDevice" | translate }}
                </span>
              </li>
            </div>
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'myReport' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('myReport')">
                <i
                  class="icon-svg_web-icon_p1_037-chart ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 16 || target === 23)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span >{{"universal_group_myReport" | translate}}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'myReport'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'myReport' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(16)"
                  [class.ala-sidenav-menu-item__active]="target === 16"
                  [routerLink]="['/dashboard/sport-report']"
                >
                  {{"universal_activityData_sportReport" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(23)"
                  [class.ala-sidenav-menu-item__active]="target === 23"
                  [routerLink]="['/dashboard/life-tracking']"
                >
                  {{"universal_lifeTracking_lifeTracking" | translate}}
                </li>
              </div>
            </div>
          </section>

          <section>
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'systemManagement' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('systemManagement')">
                <i
                  class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 13 || target === 18 || target === 19 || target === 21)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span >{{"universal_system_systemManagement" | translate }}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'systemManagement'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'systemManagement' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(13)"
                  [class.ala-sidenav-menu-item__active]="target === 13"
                  [routerLink]="['/dashboard/system/setting-member']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                >
                  <!--  之後把font awesome 與material icon 擇一-->
                  {{"universal_system_internalAdministrator" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(18)"
                  [class.ala-sidenav-menu-item__active]="target === 18"
                  [routerLink]="['/dashboard/system/inner-test']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 29"
                >
                  <!--  之後把font awesome 與material icon 擇一-->
                  {{"universal_group_rserGroupQuery" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(19)"
                  [class.ala-sidenav-menu-item__active]="target === 19"
                  [routerLink]="['/dashboard/system/inner-gpx']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
                >
                  <!--  之後把font awesome 與material icon 擇一-->
                  {{"universal_system_coordinateSystemConversion" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(21)"
                  [class.ala-sidenav-menu-item__active]="target === 21"
                  [routerLink]="['/dashboard/system/life-tracking']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
                >
                  <!--  之後把font awesome 與material icon 擇一-->
                  {{"universal_system_lifetrackingLog" | translate }}
                </li>
              </div>
            </div>
            <div
              class="nav__color"
              *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
            >
              <li
                class="ala-sidenav-item drop__down"
                (click)="chooseItem(6)"
                [class.ala-sidenav-menu-item__active]="target === 6"
                [routerLink]="['/dashboard/system/event-management']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
              >
                <i class="icon-svg_web-icon_p1_048-service ala-sidenav-icon" *ngIf="uiFlag.sidebarMode !== 'hide'"></i>
                <span class="navbar__list__title" [style.display]="uiFlag.sidebarMode !== 'expand' && !uiFlag.navFixed ? 'none' : flex">
                  {{"universal_race_racesManagement" | translate }}
                </span>
              </li>
            </div>
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'groupManagement' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('groupManagement')">
                <i
                  class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 11 || target === 12 || target === 22)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span >{{"universal_group_groupManagement" | translate }}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'groupManagement'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'groupManagement' && uiFlag.sidebarMode === 'expand' ? true : false"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(11)"
                  [class.ala-sidenav-menu-item__active]="target === 11"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/all-group-list']"
                >
                  {{"universal_group_listAllGroups" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(12)"
                  [class.ala-sidenav-menu-item__active]="target === 12"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/create-brand-group']"
                >
                  {{"universal_activityData_create" | translate }} {{"universal_group_gym" | translate }} {{"universal_group_group" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(22)"
                  [class.ala-sidenav-menu-item__active]="target === 22"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/create-com-group']"
                >
                  {{"universal_activityData_create" | translate }} {{"universal_group_company" | translate }} {{"universal_group_group" | translate }}
                </li>
              </div>
            </div>
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'push' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('push')">
                <i
                  class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 31 || target === 32)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span>推播管理</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'push'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'push' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(20)"
                  [class.ala-sidenav-menu-item__active]="target === 31"
                  [routerLink]="['/dashboard/system/create-push']"
                  *ngIf="userProfile.systemAccessRight && (userProfile.systemAccessRight[0] === 10 || userProfile.systemAccessRight[0] === 28)"
                >
                  建立推播
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(5)"
                  [class.ala-sidenav-menu-item__active]="target === 32"
                  [routerLink]="['/dashboard/system/push-list']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 29"
                >
                  推播清單
                </li>
              </div>
            </div>
            <div
              class="nav__color"
              [style.background-color]="uiFlag.currentDrop === 'deviceManagement' ? 'rgba(54, 60, 60, 1)' : 'initial'"
              *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30 && uiFlag.sidebarMode !== 'hide'"
            >
              <div class="flexRow drop__down" (click)="dropDown('deviceManagement')">
                <i
                  class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"
                  [class.ala-sidenav-menu-item__active]="uiFlag.sidebarMode === 'narrow' && (target === 5 || target === 20)"
                ></i>
                <span class="small__side navbar__list__title" [class.drop__list]="uiFlag.sidebarMode === 'expand' || uiFlag.navFixed">
                  <span >{{"universal_deviceSetting_deviceManagement" | translate }}</span>
                  <i
                    class="icon-svg_web-icon_p1_006-unfold ala-sidenav-icon"
                    [class.expand--rotate]="uiFlag.currentDrop === 'deviceManagement'"
                  ></i>
                </span>
              </div>
              
              <div
                class="navbar__list__content"
                [class.expand__content]="uiFlag.currentDrop === 'deviceManagement' && uiFlag.sidebarMode === 'expand' ? true : false"
              >
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(20)"
                  [class.ala-sidenav-menu-item__active]="target === 20"
                  [routerLink]="['/dashboard/system/device-pair-management']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                >
                  {{"universal_deviceSetting_deviceInquiry" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(5)"
                  [class.ala-sidenav-menu-item__active]="target === 5"
                  [routerLink]="['/dashboard/system/device_log']"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
                >
                  應用日誌
                </li>
              </div>
            </div>
          </section>
        </main>
        <div class="version" style="max-width: 270px;" [style.display]="uiFlag.sidebarMode !== 'expand' && !uiFlag.navFixed ? 'none' : flex">
          <div
            class="footer footer-details"
            [ngClass]="footerAddClassName"
            [style.display]="isHideFooter ? 'none' : 'block'"
          >
            {{'universal_vocabulary_footerAnnouncement' | translate: {'appName': 'GPTfit' } }}
            <div>{{'universal_ota_version' | translate}}: {{version}}</div>
          </div>
        </div>
      </div>
    </nav>
  </ng-container>
  <div class="main-body" #mainBody
    [class.preview]="isPreviewMode"
  >
    <div
      style="position: fixed; background-color: rgba(0, 0, 0, 0.3); width: 100vw; height: 100vh; z-index: 998; overflow: hidden;"
      *ngIf="uiFlag.mobileMode && uiFlag.sidebarMode === 'expand'"
      (click)="navbarFixed()"
    ></div>
    <div
      [class.container]="isHadContainer"
      [class.containerPrint]="isPreviewMode"
      [hidden]="isLoading"
    >
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
<div [hidden]="!isLoading">
  <app-loading></app-loading>
</div>
