<div class="mask" [class.mask--show]="isMaskShow" (click)="touchMask()"></div>
<div (window:resize)="onResize($event, sideNav)"
  *ngIf="!isLoading" [class.minimize-main-nav]="isSideNavOpend"
  style="display: flex;align-items: stretch;"
>
  <mat-drawer-container *ngIf="!isPreviewMode">
    <mat-drawer #sideNav opened={{isDefaultOpend}} mode={{mode}}>
      <nav class="navbar ala-dashboard-nav">
        <span class="ala-dashboard-logo">
          center
          <span class="alpha-text" *ngIf="isAlphaVersion">alpha</span>
        </span>
        <mat-nav-list style="z-index: 3;">
          <!--<mat-accordion multi="false">
            <mat-expansion-panel [expanded]="target === 1">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_002-trophy ala-sidenav-icon"></i>{{ "universal_race_leaderboard" | translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <a
                (click)="chooseItem(1, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 1"
                [routerLink]="['/leaderboard']"
                target="_blank"
              >
                <li class="ala-sidenav-menu-item">
                  Cloud Run
                </li>
              </a>
            </mat-expansion-panel>
          </mat-accordion>-->
          <mat-accordion multi="false">
            <mat-expansion-panel [expanded]="target === 3">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_003-peoples ala-sidenav-icon"></i>{{"universal_activityData_timelyActivity" | translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>
                <!-- <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(2, sideNav)"
                  [class.ala-sidenav-menu-item__active]="target === 2"
                >
                  雲跑
                </li> -->
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(3, sideNav)"
                  [class.ala-sidenav-menu-item__active]="target === 3"
                  [routerLink]="['/dashboard/live/train-live']"
                >
                  Train live
                </li>

            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion multi="false">
            <mat-expansion-panel [expanded]="target === 10 || target === 17">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_036-friends ala-sidenav-icon"></i>{{"universal_group_group" | translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(10, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 10"
                [routerLink]="['/dashboard/my-group-list']"
              >
                {{"universal_group_myGroup" | translate}}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(17, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 17"
                [routerLink]="['/dashboard/group-search']"
              >
                {{"universal_group_searchGroup" | translate}}
              </li>
            </mat-expansion-panel>
          </mat-accordion>
          <li class="ala-sidenav-item"
            (click)="chooseItem(14, sideNav)"
            [class.ala-sidenav-menu-item__active]="target === 14"
            [routerLink]="['/dashboard/activity-list']"
          >
            <i class="icon-svg_web-icon_p1_083-run ala-sidenav-icon"></i>{{"universal_activityData_myActivities" | translate}}
          </li>
          <li class="ala-sidenav-item"
            (click)="chooseItem(15, sideNav)"
            [class.ala-sidenav-menu-item__active]="target === 15"
            [routerLink]="['/dashboard/device']"
          >
            <i class="icon-svg_web-icon_p1_010-treadmill ala-sidenav-icon"></i>{{"universal_deviceSetting_myDevice" | translate }}
          </li>
          <mat-accordion multi="false">
            <mat-expansion-panel>
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_037-chart ala-sidenav-icon"></i>{{"universal_group_myReport" | translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(16, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 16"
                [routerLink]="['/dashboard/sport-report']"
              >
                {{"universal_activityData_sportReport" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(23, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 23"
                [routerLink]="['/dashboard/life-tracking']"
              >
                {{"universal_lifeTracking_lifeTracking" | translate}}
              </li>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion multi="false" *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30">
            <mat-expansion-panel [expanded]="target === 13">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"></i>{{"universal_system_systemManagement" | translate }}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(13, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 13"
                [routerLink]="['/dashboard/system/setting-member']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
              >
                <!--  之後把font awesome 與material icon 擇一-->
                {{"universal_system_internalAdministrator" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(18, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 18"
                [routerLink]="['/dashboard/system/inner-test']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
              >
                <!--  之後把font awesome 與material icon 擇一-->
                {{"universal_group_rserGroupQuery" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(19, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 19"
                [routerLink]="['/dashboard/system/inner-gpx']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
              >
                <!--  之後把font awesome 與material icon 擇一-->
                {{"universal_system_coordinateSystemConversion" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(21, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 21"
                [routerLink]="['/dashboard/system/life-tracking']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
              >
                <!--  之後把font awesome 與material icon 擇一-->
                {{"universal_system_lifetrackingLog" | translate }}
              </li>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion multi="false" *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30">
            <mat-expansion-panel [expanded]="target === 6 || target === 7 || target === 8|| target === 9">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <!--  之後把font awesome 與material icon 擇一-->
                  <i class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"></i>{{"universal_race_racesManagement" | translate }}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(6, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 6"
                [routerLink]="['/dashboard/system/event-management']"
              >
                {{"universal_race_racesOverview" | translate }}
              </li>

              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(7, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 7"
                [routerLink]="['/dashboard/system/event']"
              >
                {{"universal_race_createAndEditRaces" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(8, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 8"
                [routerLink]="['/dashboard/system/event-calendar']"
              >
                {{"universal_race_racesLog" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(9, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 9"
                [routerLink]="['/dashboard/system/leaderboard-settings']"
              >
                {{"universal_race_updateRanking" | translate }}
              </li>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion multi="false" *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30">
            <mat-expansion-panel [expanded]="target === 11 || target === 12 || target === 22">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <i class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"></i>{{"universal_group_groupManagement" | translate }}
                </mat-panel-title>
              </mat-expansion-panel-header>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(11, sideNav)"
                  [class.ala-sidenav-menu-item__active]="target === 11"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/all-group-list']"
                >
                  {{"universal_group_listAllGroups" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(12, sideNav)"
                  [class.ala-sidenav-menu-item__active]="target === 12"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/create-brand-group']"
                >
                  {{"universal_activityData_create" | translate }} {{"universal_group_gym" | translate }} {{"universal_group_group" | translate }}
                </li>
                <li class="ala-sidenav-menu-item"
                  (click)="chooseItem(22, sideNav)"
                  [class.ala-sidenav-menu-item__active]="target === 22"
                  *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
                  [routerLink]="['/dashboard/system/create-com-group']"
                >
                  {{"universal_activityData_create" | translate }} {{"universal_group_company" | translate }} {{"universal_group_group" | translate }}
                </li>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion multi="false" *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30">
            <mat-expansion-panel [expanded]="target === 5">
              <mat-expansion-panel-header  class="ala-expansion-panel-header"
                [collapsedHeight]="'100%'" [expandedHeight]="'100%'"
              >
                <mat-panel-title>
                  <!--  之後把font awesome 與material icon 擇一-->
                  <i class="icon-svg_web-icon_p1_048-service ala-sidenav-icon"></i>
                  {{"universal_deviceSetting_deviceManagement" | translate }}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(20, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 20"
                [routerLink]="['/dashboard/system/device-pair-management']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] < 30"
              >
                {{"universal_deviceSetting_deviceInquiry" | translate }}
              </li>
              <li class="ala-sidenav-menu-item"
                (click)="chooseItem(5, sideNav)"
                [class.ala-sidenav-menu-item__active]="target === 5"
                [routerLink]="['/dashboard/system/device_log']"
                *ngIf="userProfile.systemAccessRight && userProfile.systemAccessRight[0] <= 20"
              >
                {{"universal_deviceSetting_deviceLog" | translate }}
              </li>
            </mat-expansion-panel>
          </mat-accordion>
        </mat-nav-list>
      </nav>
      <div class="version">
        <div
          class="footer footer-details"
          [ngClass]="footerAddClassName"
          [style.display]="isHideFooter ? 'none' : 'block'"
        >
          {{'universal_vocabulary_footerAnnouncement' | translate: {'appName': 'Center' } }}
          <div>{{'universal_ota_version' | translate}}: {{version}}</div>
        </div>
      </div>
    </mat-drawer>
    <mat-drawer-content>
      <header class="header header__color ala-dashboard-header">
      <div class="mobile-menu-toggle">
        <div class="main-nav-toggle"
          [class.minimize-main-nav]="!isSideNavOpend"
          (click)="toggleSideNav(sideNav)"
        >
          <i class="icon-svg_web-icon_p1_073-level_fold main-nav-toggle-icon"
          ></i>
          <i class="icon-svg_web-icon_p1_005-menu main-nav-toggle-icon"></i>
        </div>
      </div>
        <div style="display: flex; position: fixed; right: 20px">
          <div class="dropdown">
            <div class="header-nav-item" id="dropdownMenu3" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              <div class="header-nav-item" style="margin-right: 10px">
                {{ userProfile.nickname || '' }}
              </div>
              <img
                [src]="userProfile.avatarUrl"
                class="header-user-photo"
                (error)="this.userProfile.avatarUrl='/assets/images/user2.png'"
              >
              <i
                class="icon-svg_web-icon_p1_069-about"
                style="color: #ff3838; font-size: 30px; position: absolute; right: -15px; bottom: 0px;"
                *ngIf="accountStatus === 1"
              ></i>
            </div>
            <div class="dropdown-menu dropdown-user-menu" [class.show]="isUserMenuShow"
               aria-labelledby="dropdownMenu3"
            >
              <div class="header-nav-menu-section">
                <!-- <div (click)="$event.preventDefault();$event.stopPropagation();"
                  style="padding: 15px 20px"
                >
                  {{ userName || '' }}
                </div> -->
              </div>
              <div class="header-nav-menu-section">
                <ul>
                  <li style="color: #ff3838; font-weight: bold;" [routerLink]="['/enableAccount-web']" *ngIf="accountStatus === 1">
                    {{ "universal_deviceSetting_switch" | translate}} {{ "universal_userAccount_account" | translate}}
                  </li>
                  <li (click)="goToUserProfile(userProfile.userId)">
                    {{ "universal_userProfile_info" | translate}}
                  </li>
                  <li [routerLink]="['/dashboard/settings']">
                    {{ "universal_system_accountManagement" | translate}}
                  </li>
                </ul>
              </div>
              <button class="dropdown-item" type="button" (click)="logout()">{{ "universal_userAccount_logOut" | translate}}</button>
            </div>
          </div>
        </div>
      </header>
    </mat-drawer-content>
  </mat-drawer-container>
  <div class="main-body" #mainBody
    [class.preview]="isPreviewMode"
  >
    <div
      [class.container]="isHadContainer"
      [class.containerPrint]="isPreviewMode"
      [hidden]="isLoading"
    >
      <router-outlet></router-outlet>
    </div>
  </div>
</div>

<div [hidden]="!isLoading">
  <app-loading></app-loading>
</div>
