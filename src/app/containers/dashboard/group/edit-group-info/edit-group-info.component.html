<div class="row">
  <div class="col-4">
    <img *ngIf="groupImg" style="width: 100%" [src]="(groupImg | safeHtml)">
  </div>
  <div class="col-8">
    <form [formGroup]="form" (ngSubmit)="manage()" #f="ngForm" novalidate>
      <div class="d-flex justify-content-between" style="margin-bottom: 15px">
        <span style="color: #26abe3; font-weight:700">
          群組資訊
        </span>
        <div>
          <!-- <button class="alatech-btn alatech-btn--default" title="返回" [routerLink]="['/dashboard/my-group-list']">
            管理
          </button> -->
          <button class="alatech-btn alatech-btn--default" title="申請加入" *ngIf="joinStatus === 0" (click)="handleActionGroup(1)">
            申請加入
          </button>
          <button class="alatech-btn alatech-btn--default group-btn--waiting" title="取消申請" *ngIf="joinStatus === 1" (click)="handleActionGroup(2)">
            取消申請
          </button>
          <button class="alatech-btn alatech-btn--default" title="管理" *ngIf="joinStatus === 2" (click)="goEditPage()">
            申請解散品牌
          </button>
          <button class="alatech-btn alatech-btn--default" title="管理" *ngIf="joinStatus === 2" (click)="goEditPage()">
            新增子群組
          </button>
          <button class="alatech-btn alatech-btn--default"
            title="完成管理"
            *ngIf="joinStatus === 2"
            type="submit"
          >
            完成管理
          </button>
          <!-- <button class="alatech-btn alatech-btn--default"
            title="管理"
            *ngIf="joinStatus === 2 && accessRight === 30"
          >
            管理
          </button> -->
        </div>
      </div>
      <div style="margin-bottom: 30px;">
        <div>
          <label>群組ID：</label>{{ group_id }}
        </div>
        <div class="ala-list__item">
          <label class="ala-form__label">名稱：</label>
          <app-form-text
            [content]="groupInfo?.groupName"
            [maxLength]="32"
            [remindText]="remindText"
            [invalidRemindText]="inValidText"
            [control]="form"
            [controlName]="formTextName"
            [isInvalid]="(!groupName.valid && groupName.touched) || (f.submitted && groupName.hasError('required')) || (f.submitted && groupName.hasError('maxLength'))"
          >
          </app-form-text>
        </div>
        <div class="ala-list__item">
          <label class="ala-form__label">狀態：</label>
          <select class="form-field">
            <option class="form-field-option">{{ groupInfo?.groupStatus | groupStatus }}</option>
            <option class="form-field-option">審核制</option>
            <option class="form-field-option">隱藏群組</option>
          </select>
        </div>
        <div class="ala-list__item">
          <label class="ala-form__label">介紹：</label>
          <div style="width: calc(100% - 50px)">
            <app-form-textarea
              [maxLength]="textareaMaxLength"
              [content]="groupInfo?.groupDesc"
              [control]="form"
              [controlName]="formTextareaName"
              (onChange)="handleChangeTextarea($event)"
              [isInvalid]="(!groupDesc.valid && groupDesc.touched) || (f.submitted && groupDesc.hasError('required')) || (f.submitted && groupDesc.hasError('maxLength'))"
            >
            </app-form-textarea>
          </div>
        </div>
      </div>
      <div>
        <mat-tab-group (selectChange)="changeGroupInfo($event)" class="ala-tab-group">
          <mat-tab label="子群組資訊" (click)="getGroupMemberList(1)">
            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">品牌</label>

            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let subBrandItem of subBrandInfo">
                <app-member-capsule
                  [role]="role"
                  [isSubGroupInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer"
                  [title]="subBrandItem?.group_name"
                  [memberInfo]="subBrandItem"
                  [name]="subBrandItem && subBrandItem?.group_name"
                  [icon]="subBrandItem?.group_icon"
                >
                </app-member-capsule>
              </ng-container>
            </div>

            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">分店</label>
            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let subBranchItem of subBranchInfo">
                <app-member-capsule
                  [role]="role"
                  [isSubGroupInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer || role?.isBrandAdministrator"
                  [title]="subBranchItem?.group_name"
                  [memberInfo]="subBranchItem"
                  [name]="subBranchItem && subBranchItem?.group_name"
                  [icon]="subBranchItem?.group_icon"
                >
                </app-member-capsule>
              </ng-container>
            </div>

            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">教練課</label>
            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let subCoachItem of subCoachInfo">
                <app-member-capsule
                  [role]="role"
                  [isSubGroupInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer || role?.isBrandAdministrator || role?.isBranchAdministrator"
                  [title]="subCoachItem?.userIcon"
                  [memberInfo]="subCoachItem"
                  [name]="subCoachItem && subCoachItem?.group_name"
                  [icon]="subCoachItem?.group_icon"
                >
                </app-member-capsule>
              </ng-container>
            </div>
          </mat-tab>
          <mat-tab label="管理員資訊" (click)="getGroupMemberList(2)">
            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">品牌層管理員</label>
            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let brandAdmItem of brandAdministrators">
                <app-member-capsule
                  [role]="role"
                  [isAdminInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer"
                  [title]="brandAdmItem?.memberName"
                  [memberInfo]="brandAdmItem"
                  [name]="brandAdmItem && brandAdmItem?.memberName"
                  [icon]="brandAdmItem?.userIcon"
                >
                </app-member-capsule>
              </ng-container>
            </div>

            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">分店層管理員</label>
            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let branchAdmItem of branchAdministrators">
                <app-member-capsule
                  [role]="role"
                  [isAdminInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer || role?.isBrandAdministrator"
                  [title]="branchAdmItem?.memberName"
                  [memberInfo]="branchAdmItem"
                  [name]="branchAdmItem && branchAdmItem?.memberName"
                  [icon]="branchAdmItem?.userIcon"
                >
                </app-member-capsule>
              </ng-container>
            </div>

            <label style="color: #26abe3; font-weight: 700;margin-bottom: 15px">教練課管理員</label>
            <div style="margin-bottom: 15px">
              <ng-container  *ngFor="let coachAdmItem of coachAdministrators">
                <app-member-capsule
                  [role]="role"
                  [isAdminInfo]="role?.isSupervisor || role?.isSystemDeveloper || role?.isSystemMaintainer || role?.isBrandAdministrator || role?.isBranchAdministrator"
                  [title]="coachAdmItem?.memberName"
                  [memberInfo]="coachAdmItem"
                  [name]="coachAdmItem && coachAdmItem?.memberName"
                  [icon]="coachAdmItem?.userIcon"
                >
                </app-member-capsule>
              </ng-container>
            </div>
          </mat-tab>
          <mat-tab label="一般成員資訊">
            <ng-container  *ngFor="let item of groupInfos">
              <div style="margin-bottom: 15px">
                <app-member-capsule
                  [role]="role"
                  [isAdminInfo]="true"
                  [title]="item?.memberName"
                  [memberInfo]="item"
                  [name]="item && item?.memberName"
                  [icon]="item?.userIcon"
                >
                </app-member-capsule>
              </div>
            </ng-container>
          </mat-tab>
        </mat-tab-group>
      </div>
    </form>
  </div>
</div>
