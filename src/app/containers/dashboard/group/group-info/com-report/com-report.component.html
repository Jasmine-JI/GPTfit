<ng-container *ngIf="!isPreviewMode">
  <div class="searchReport">
    <p style="font-size: 18px; color: #26abe3;">{{'SH.create' | translate}}{{'Dashboard.SportReport.sportReport' | translate}}</p>
    <p>{{'other.followExerciseTypeCreate' | translate}}</p>
    <div class="searchInput">
      <div class="selectArea">
        <div class="sportCategory" *ngIf="1 ==='1'">
          <p style="white-space: nowrap; margin: 0px">{{'Dashboard.GroupClass.activityType' | translate}}：</p>
          <mat-form-field style="width: 100px;" appearance="none" class="trainLiveCategroy">
            <mat-select [(value)]="reportCategory" (selectionChange)="changeSportCategory()">
              <mat-option value="99">{{'SH.all' | translate}}</mat-option>
              <mat-option value="1">{{'Dashboard.SportReport.run' | translate}}</mat-option>
              <mat-option value="2">{{'Dashboard.SportReport.cycle' | translate}}</mat-option>
              <mat-option value="3">{{'Dashboard.SportReport.weightTraining' | translate}}</mat-option>
              <mat-option value="4">{{'Dashboard.SportReport.swim' | translate}}</mat-option>
              <mat-option value="5">{{'Dashboard.SportReport.aerobic' | translate}}</mat-option>
              <mat-option value="6">{{'Dashboard.SportReport.boating' | translate}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="datetimeInput">
          <p style="white-space: nowrap; margin: 0px">{{'SH.dateRange' | translate}}：</p>
          <app-date-range-picker
            (selectDateRange)="getSelectDate($event)"
            [default]="defaultDate"
            [style.pointer-events]="isLoading? 'none' : ''"
          ></app-date-range-picker>
        </div>
      </div>
    </div>
  </div>
</ng-container>
<ng-container *ngIf="isLoading" style="display:flex;justify-content: center;align-items: center; width:100%;">
  <mat-spinner style="z-index: 3; margin-top: 30px; position: absolute; left: 50%;"></mat-spinner>
  <div class="whiteMask">
  </div>
</ng-container>
<ng-container *ngIf="nodata && !isLoading" style="width: 100%; display: flex; flex-direction: row; justify-content: center;">
  <p style="margin-top: 10px; color: gray; font-size: 18px;">{{'Dashboard.System.nodata' | translate}}</p>
</ng-container>
<ng-container *ngIf="!isLoading && !nodata && showReport" style="width: 100%; min-height: 100%; padding-bottom: 30px;">
  <div class="functionButton">
    <button class="alatech-btn alatech-btn--default activity-btn"
      title="{{'SH.print' | translate}}"
      (click)="print()"
      *ngIf="isPreviewMode"
    >
      {{'SH.print' | translate}}
    </button>
    <a target="_blank"
      [href]="previewUrl"
      class="alatech-btn--default"
      *ngIf="!isPreviewMode"
    >
      <i class="icon-svg_web-icon_p2_087-print activity-info_icon_size"></i>
    </a>
  </div>
  <div [class.fitWindow]="!isPreviewMode">
    <div class="flexRow reportHeader" [class.media-1000-col]="!isPreviewMode">
      <div class="flexRow">
        <div class="activity-icon" *ngIf="reportCategory === '99'">
          <i class="icon-svg_web-icon_p2_038-complex"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '1'">
          <i class="icon-svg_web-icon_p1_083-run"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '2'">
          <i class="icon-svg_web-icon_p1_084-cycle"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '3'">
          <i class="icon-svg_web-icon_p1_086-weight_training"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '4'">
          <i class="icon-svg_web-icon_p1_085-swim"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '5'">
          <i class="icon-svg_web-icon_p1_087-aerobic"></i>
        </div>
        <div class="activity-icon" *ngIf="reportCategory === '6'">
          <i class="icon-svg_web-icon_p1_088-row"></i>
        </div>
        <div class="flexCol" style="margin-left: 20px;">
          <span class="reportDateTime">從{{reportEndDate}}起，過去 {{period}} 所建立</span>
          <span *ngIf="reportCategory === '99'" class="reportTitle">
            {{'other.activityTotals' | translate}} {{'other.report' | translate}}
          </span>
          <span *ngIf="reportCategory === '1'" class="reportTitle">
            {{'Dashboard.SportReport.run' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
          <span *ngIf="reportCategory === '2'" class="reportTitle">
            {{'Dashboard.SportReport.cycle' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
          <span *ngIf="reportCategory === '3'" class="reportTitle">
            {{'Dashboard.SportReport.weightTraining' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
          <span *ngIf="reportCategory === '4'" class="reportTitle">
            {{'Dashboard.SportReport.swim' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
          <span *ngIf="reportCategory === '5'" class="reportTitle">
            {{'Dashboard.SportReport.aerobic' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
          <span *ngIf="reportCategory === '6'" class="reportTitle">
            {{'Dashboard.SportReport.boating' | translate}} {{'Dashboard.SportReport.sportReport' | translate}}
          </span>
        </div>
      </div>
      <div class="flexRow authorInfo">
        <div class="flexCol">
          <span class="reportTitle" style="margin: 10px 10px 0px 0px;">{{groupData?.groupName}}</span>
          <span class="reportDateTime" *ngIf="branchName !== ''">{{brandName}} \ {{branchName}}</span>
          <span class="reportDateTime" *ngIf="branchName === '' && brandName !== ''">{{brandName}}</span>
        </div>
        <div style="margin-right: 10px;">
          <img style="width: 55px; border-radius: 50%;" src="{{groupImg}}">
        </div>
      </div>
    </div>
  </div>
  <div class="flexCol">
    <div class="activity-title flexRow" style="justify-content: space-between;">
      <span class="ala-dashboard-title">{{'Dashboard.ActivityDetail.summary' | translate}}</span>
      <span class="reportDateTime" style="text-align: end;">
        {{'Dashboard.GroupClass.creatTime' | translate}} {{reportCreatedTime}}
      </span>
    </div>
    <div>
      <div class="summaryArea">
        <div class="summaryDataArea">
          <span class="summaryData">{{passPrivacyNum || 0}}</span>
          <p class="summaryDescription">{{'other.people' | translate}}</p>
        </div>
        <div class="sepLine"></div>
        <div class="summaryDataArea">
          <span class="summaryData">{{categoryActivityLength || 0}}</span>
          <p class="summaryDescription">{{'other.totalActivity' | translate}}</p>
        </div>
        <div class="sepLine"></div>
        <div class="summaryDataArea">
          <span class="summaryData">{{totalTime || 0}}</span>
          <p class="summaryDescription">{{'Dashboard.SportReport.totalTime' | translate}}</p>
        </div>
        <div class="sepLine"></div>
        <div class="summaryDataArea">
          <span class="summaryData">{{avgTime || 0}}</span>
          <p class="summaryDescription">
            {{'other.perCapita' | translate}} {{'Dashboard.MyActivity.timing' | translate}}
          </p>
        </div>
        <div class="sepLine"></div>
        <div class="summaryDataArea">
          <div>
            <div *ngIf="totalCalories >= 1000">
              <span class="summaryData">{{totalCalories / 1000 || 0 | number:'1.0-2'}}k</span>
              <span class="infoDataUnit"> cal</span>
            </div>
            <div *ngIf="totalCalories < 1000">
              <span class="summaryData">{{totalCalories || 0 | number:'1.0-0'}}</span>
              <span class="infoDataUnit"> cal</span>
            </div>
          </div>
          <p class="summaryDescription">{{'other.totalCalories' | translate}}</p>
        </div>
        <div class="sepLine"></div>
        <div class="summaryDataArea">
          <div *ngIf="avgPersonCalories >= 1000">
            <span class="summaryData">{{avgPersonCalories / 1000 || 0 | number:'1.0-2'}}k</span>
            <span class="infoDataUnit"> cal</span>
          </div>
          <div *ngIf="avgPersonCalories < 1000">
            <span class="summaryData">{{avgPersonCalories || 0 | number:'1.0-1'}}</span>
            <span class="infoDataUnit"> cal</span>
          </div>
          <p class="summaryDescription">
            {{'other.perCapita' | translate}} {{'Dashboard.SportReport.totalCalorie' | translate}}
          </p>
        </div>
        <div class="sepLine" *ngIf="reportCategory !== '99' && reportCategory !== '3' && reportCategory !== '5'"></div>
        <div class="summaryDataArea" *ngIf="reportCategory !== '99' && reportCategory !== '3' && reportCategory !== '5'">
          <div *ngIf="totalDistance >= 1000">
            <span class="summaryData">{{totalDistance / 1000 || 0 | number:'1.0-1'}}</span>
            <span class="infoDataUnit"> km</span>
          </div>
          <div *ngIf="totalDistance < 1000">
            <span class="summaryData">{{totalDistance || 0 | number:'1.0-1'}}</span>
            <span class="infoDataUnit"> m</span>
          </div>
          <p class="summaryDescription">{{'Dashboard.SportReport.totalDistance' | translate}}</p>
        </div>
        <div class="sepLine" *ngIf="reportCategory === '3'"></div>
        <div class="summaryDataArea" *ngIf="reportCategory === '3'">
          <div *ngIf="totalWeight >= 1000">
            <span class="summaryData" >{{totalWeight / 1000 || 0 | number:'1.0-1'}}</span>
            <span class="infoDataUnit"> tn</span>
          </div>
          <div *ngIf="totalWeight < 1000">
            <span class="summaryData" >{{totalWeight || 0 | number:'1.0-1'}}</span>
            <span class="infoDataUnit"> kg</span>
          </div>
          <p class="summaryDescription">{{'SH.totalWeight' | translate}}</p>
        </div>
      </div>
    </div>
  </div>
  <div class="flexCol" *ngIf="reportCategory === '99'">
    <div class="activity-title flexRow" style="justify-content: space-between;">
      <span class="ala-dashboard-title">{{'other.activityAnalysis' | translate}}</span>
    </div>
    <div class="areaDescription">
      {{'other.activityAnalysisReportDescription' | translate}}
    </div>
    <div class="flexRow media-769-col">
      <div class="flexCol ringChart">
        <div class="flexRow">
          <div class="flexCol ringChartSection">
            <span style="font-weight: bold;">{{'other.amountOfQuantity' | translate}}</span>
            <app-ring-chart [data]="perTypeLength" [selectType]="selectType" *ngIf="!isLoading && !isRxjsLoading"></app-ring-chart>
          </div>
          <div class="flexCol ringChartSection">
            <span style="font-weight: bold;">{{'other.proportionOfTime' | translate}}</span>
            <app-ring-chart [data]="perTypeTime" [selectType]="selectType" *ngIf="!isLoading && !isRxjsLoading"></app-ring-chart>
          </div>
        </div>
        <div class="flexRow" style="flex-wrap: wrap;">
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[0] !== 0" (click)="assignCategory('1')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '1' || selectType === '99' ? '#ea5757' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.run' | translate}} {{perTypeLength[0]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[0] | sportTime}}</span>
          </div>
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[1] !== 0" (click)="assignCategory('2')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '2' || selectType === '99' ? '#ff9a22' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.cycle' | translate}} {{perTypeLength[1]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[1] | sportTime}}</span>
          </div>
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[2] !== 0" (click)="assignCategory('3')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '3' || selectType === '99' ? '#f9cc3d' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.weightTraining' | translate}} {{perTypeLength[2]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[2] | sportTime}}</span>
          </div>
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[3] !== 0" (click)="assignCategory('4')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '4' || selectType === '99' ? '#cfef4b' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.swim' | translate}} {{perTypeLength[3]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[3] | sportTime}}</span>
          </div>
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[4] !== 0" (click)="assignCategory('5')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '5' || selectType === '99' ? '#75f25f' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.aerobic' | translate}} {{perTypeLength[4]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[4] | sportTime}}</span>
          </div>
          <div class="flexCol perTypeInfo" *ngIf="perTypeLength && perTypeLength[5] !== 0" (click)="assignCategory('6')">
            <div class="flexRow">
              <span
                class="dot"
                [style.color]="selectType === '6' || selectType === '99' ? '#72e8b0' : '#9e9e9e'"
              >●</span>
              <span class="perTypeTitle">
                {{'Dashboard.SportReport.boating' | translate}} {{perTypeLength[5]}} {{'other.perStroke' | translate}}
              </span>
            </div>
            <span class="perTypeAvgTime">{{'Dashboard.MyActivity.totalTime' | translate}} {{perTypeTime[5] | sportTime}}</span>
          </div>
        </div>
      </div>
      <div class="flexCol distributionChartWidth">
        <span style="font-weight: bold; margin-bottom: 15px;">
          {{'other.activityEffectivenessMap' | translate}}
          <span *ngIf="dataDateRange === 'day'">({{'Dashboard.SportReport.day' | translate}})</span>
          <span *ngIf="dataDateRange === 'week'">({{'other.week' | translate}})</span>
        </span>
        <app-distribution-chart
          [typeList]="typeList"
          [perAvgHR]="perAvgHR"
          [perActivityTime]="perActivityTime"
          [selectType]="selectType"
          [HRRange]="[60, 190]"
          *ngIf="!isLoading && !isRxjsLoading"
          class="distributionChart"
        >
        </app-distribution-chart>
      </div>
    </div>
  </div>
  <div class="flexCol" *ngIf="reportCategory !== '3'">
    <span class="ala-dashboard-title activity-title" style="margin-bottom: 5px;">{{'SH.hrZone' | translate}}</span>
    <div class="flexRow media-769-col">
      <div class="flexCol" id="HRZoneChart">
        <p class="areaDescription">
          {{'other.hrStatisticsDuringThePeriod' | translate: {'number': categoryActivityLength } }}
        </p>
        <div>
          <div>
            <p class="chartTitle">{{'other.hrZoneLandingPoint' | translate}}</p>
          </div>
          <div>
            <app-hrzone-chart
              [data]="typeHrZone"
              [type]="'mixHrZone'"
              *ngIf="!isLoading && !isRxjsLoading"
            ></app-hrzone-chart>
          </div>
        </div>
      </div>
      <div id="HRInfo">
        <app-hrzone-info [hrZoneRange]="hrZoneRange" *ngIf="!isLoading && !isRxjsLoading"></app-hrzone-info>
      </div>
    </div>
  </div>
  <div class="flexCol" *ngIf="reportCategory !== '3'">
    <span class="ala-dashboard-title activity-title">{{'other.hrZoneTrend' | translate}}</span>
    <div>
      <p class="areaDescription">
        {{'other.hrZoneTrendReportDescription' | translate}}
      </p>
      <div>
        <app-stack-column-chart
          [perHrZoneData]="perHrZoneData"
          [dateRange]="dataDateRange"
          *ngIf="!isLoading && !isRxjsLoading"
        >
        </app-stack-column-chart>
      </div>
    </div>
  </div>
  <div class="flexCol" *ngIf="reportCategory === '3'">
    <span class="ala-dashboard-title activity-title">{{'other.weightTrainingEffectiveness' | translate}}</span>
    <div>
      <p class="areaDescription">
        {{'other.muscleColorIllustration' | translate}}
      </p>
      <div class="HRZone" *ngIf="!(initialChartComplated && !showHRZoneChartTarget)">
        <div #HRZoneChartTarget class="chart">
          chart target
        </div>
      </div>
    </div>
  </div>
  <div class="flexCol" *ngIf="reportCategory === '3'">
    <span class="ala-dashboard-title activity-title">{{'other.trainingTrend' | translate}}</span>
    <div>
      <p class="areaDescription">
        {{'other.trainingTrendDescription' | translate}}
      </p>
      <div class="HRZone" *ngIf="!(initialChartComplated && !showHRZoneChartTarget)">
        <div #HRZoneChartTarget class="chart">
          chart target
        </div>
      </div>
    </div>
  </div>
  <div class="flexCol">
      <p class="ala-dashboard-title activity-title">{{'Dashboard.TrainLive.trend' | translate}}</p>
      <div class="flexCol" *ngIf="reportCategory === '2'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'SH.speed' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestSpeed || 0 | number:'1.0-0'}}</span>
              <span class="dataAnnotation">{{'other.maxSpeedPerHour' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgSpeed || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'other.avgSpeedPerHour' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perSpeedData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Speed'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '1' || reportCategory === '4' || reportCategory === '6'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle" *ngIf="reportCategory === '1'">{{'other.kilometerPace' | translate}}</span>
          <span class="reportChartTitle" *ngIf="reportCategory === '4'">{{'other.100mPace' | translate}}</span>
          <span class="reportChartTitle" *ngIf="reportCategory === '6'">{{'other.500mPace' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestPace}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.liveBestPace' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgPace}}</span>
              <span class="dataAnnotation">{{'SH.avgPace' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perPaceData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Pace'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '2' || reportCategory === '6'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'SH.power' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestPower || 0 | number:'1.0-0'}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.maxPower' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgPower || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.avgPower' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-compare-line-chart
              [data]="perPowerData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Power'"
              [chartHeight]="110"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-compare-line-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '1'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'other.stepCadence' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestCadence || 0}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.maxStepCadence' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgCadence || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.avgStepCadence' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perCadenceData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Cadence'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '2'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'SH.CyclingCadence' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestCadence || 0}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.maxCyclingCadence' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgCadence || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'Dashboard.SportReport.avgCyclingCadence' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perCadenceData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Cadence'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '4'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'Dashboard.MyActivity.swimCadence' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestCadence || 0}}</span>
              <span class="dataAnnotation">{{'Dashboard.MyActivity.baetSwimReps' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgCadence || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'Dashboard.MyActivity.avgSwimReps' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perCadenceData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Cadence'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '6'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'other.rowCadence' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestCadence || 0}}</span>
              <span class="dataAnnotation">{{'Dashboard.MyActivity.baetRowReps' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgCadence || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'Dashboard.MyActivity.avgRowCadence' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perCadenceData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Cadence'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol" *ngIf="reportCategory === '4'">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">Swolf</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{bestSwolf || 0}}</span>
              <span class="dataAnnotation">{{'other.bestSwolf' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgSwolf || 0 | number:'1.0-1'}}</span>
              <span class="dataAnnotation">{{'other.avgSwolf' | translate}}</span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-discolor-column-chart
              [data]="perSwolfData"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Swolf'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-discolor-column-chart>
          </div>
        </div>
      </div>
      <div class="flexCol">
        <div class="flexRow" style="align-items: center;">
          <span class="reportChartTitle">{{'SH.calories' | translate}}</span>
          <div class="separateLine"></div>
        </div>
        <div class="flexRow dataContent" [class.media-1000-dataContent]="!isPreviewMode">
          <div class="flexRow dataNumber" [class.media-1000-dataNumber]="!isPreviewMode">
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont" *ngIf="bestCalories / 1000 >= 1">{{bestCalories / 1000 || 0 | number:'1.0-1'}}kcal</span>
              <span class="dataFont" *ngIf="bestCalories / 1000 < 1">{{bestCalories || 0 | number:'1.0-0'}}cal</span>
              <span class="dataAnnotation">{{'SH.maxBig' | translate}} {{'SH.calories' | translate}}</span>
            </div>
            <div class="flexCol dataMargin" style="width: 50%;">
              <span class="dataFont">{{avgCalories || 0 | number:'1.0-1'}}cal</span>
              <span class="dataAnnotation">
                {{'Dashboard.TrainLive.avg' | translate}} {{'SH.calories' | translate}}
              </span>
            </div>
          </div>
          <div class="dataChart" [class.media-1000-dataChart]="!isPreviewMode">
            <app-fillet-column-chart
              [data]="perCalories"
              [dateRange]="dataDateRange"
              [sportType]="reportCategory"
              [chartName]="'Calories'"
              *ngIf="!isLoading && !isRxjsLoading"
            >
            </app-fillet-column-chart>
          </div>
        </div>
      </div>
  </div>
  <div class="printMark" *ngIf="isPreviewMode && !isLoading" class="printMark">
    GPT Center
  </div>
  <div class="pageBreak" *ngIf="isPreviewMode"></div>

  <div
    class="flexCol"
    style="margin-bottom: 50px;"
  >
    <div class="flexRow activity-title" style="justify-content: space-between;">
      <span class="ala-dashboard-title">
        {{'other.groupAnalysis' | translate}}
      </span>
      <div *ngIf="!isPreviewMode">
        <i
          class="icon-svg_web-icon_p1_001-setting"
          style="font-size: 25px; cursor: pointer;"
          (click)="showTableList('group')"
        ></i>
        <div
          class="flexCol tableMenu"
          style="position: absolute; right: 20px; padding: 10px; max-height: 300px; overflow-y: auto;"
          (mouseenter)="handleScrollEvent(true, 'table')"
          (mouseleave)="handleScrollEvent(false, 'table')"
          (touchstart)="handleScrollEvent(true, 'table')"
          (touchend)="handleScrollEvent(false, 'table')"
          *ngIf="showTableMenu.group"
        >
          <div *ngIf="+groupLevel <= 40">
            <span class="tableMenuTitle">{{'other.filter' | translate}} {{'Dashboard.Group.group' | translate}}</span>
            <div class="tableCheckbox" *ngFor="let list of groupTableTypeList.filter">
              <mat-checkbox
                color="primary"
                value="{{list.id}}"
                [checked]="list.checked"
                (change)="changeTableType($event, 'group', 'filter')"
                [style.pointer-events]="tableTypeListOpt.tableCheckedNum.group.filter <= 1 && list.checked === true ? 'none' : ''"
                [style.color]="tableTypeListOpt.tableCheckedNum.group.filter <= 1 && list.checked === true ? '#ababab' : ''"
                *ngIf="+groupLevel <= 30 || list.id !== 0"
              >
                <span style="font-size: 14px">
                  {{ list.i18n }}
                </span>
              </mat-checkbox>
            </div>
          </div>
          <div>
            <div class="flexRow">
              <span class="tableMenuTitle">{{'other.fieldDisplay' | translate}}</span>
              <span
                style="font-size: 8px; margin-left: 5px;"
                [style.color]="tableTypeListOpt.tableCheckedNum.group.column >= tableTypeListOpt.max ? 'red' : '#ababab'"
              >
                ({{ 'other.upTo' | translate: {'number': tableTypeListOpt.max} }})
              </span>
            </div>
            <div class="tableCheckbox" *ngFor="let list of groupTableTypeList.column">
              <mat-checkbox
                color="primary"
                value="{{list.id}}"
                [checked]="list.checked"
                (change)="changeTableType($event, 'group', 'column')"
                *ngIf="!(diffDay < 14 && list.id === 2)"
                [style.pointer-events]="
                  (tableTypeListOpt.tableCheckedNum.group.column >= tableTypeListOpt.max && list.checked === false)
                  || (tableTypeListOpt.tableCheckedNum.group.column <= tableTypeListOpt.min && list.checked === true)
                  ? 'none' : ''
                "
                [style.color]="
                  (tableTypeListOpt.tableCheckedNum.group.column >= tableTypeListOpt.max && list.checked === false)
                  || (tableTypeListOpt.tableCheckedNum.group.column <= tableTypeListOpt.min && list.checked === true)
                  ? '#ababab' : ''
                "
              >
                <span style="font-size: 14px">
                  {{ list.i18n }}
                </span>
              </mat-checkbox>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div style="margin-top: 10px;">
      <mat-table [dataSource]="tableData.display.group.data" matSort #groupSortTable="matSort"  (matSortChange)="sortGroupData()">
        <ng-container matColumnDef="name">
          <mat-header-cell *matHeaderCellDef disableClear="true" class="tableArrangement" id="groupName">
            <span
              class="tableTitleWord"
              style="text-align: start;"
            >
              {{'Dashboard.Group.MyGroup.name' | translate}}
            </span>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent flexCol"
            style="align-items: flex-start; justify-content: center;"
          >
            <span style="text-align: start; font-size: 10px; color: #c5c5c5;">{{row?.data.gName.upLevelName}}</span>
            <span
              style="text-align: start;"
              [style.color]="groupMenu.focusGid === row?.gid ? '#157fcc' : ''"
            >
              {{row?.data.gName.groupName}}
            </span>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="memberNum">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[0].checked ? '' : 'none'"
          >
            <span class="tableTitleWord">{{'other.people' | translate}}</span>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[0].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'memberNum'"
            ></div>
            <div class="flexRow setIn">
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon"
                *ngIf="row?.data.notPassPrivacyNum > 0"
              ></i>
              <span>{{row?.data.memberNum | number: '1.0-0'}}</span>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="avgActivityNum">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[1].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.perCapita' | translate}} {{'other.numberOf' | translate}}
              </span>
              <span class="chartTitleUnit">times</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[1].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'avgActivityNum'"
            ></div>
            <span class="setIn">{{row?.data.avgActivityNum | number: '1.0-0'}}</span>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="weekFrequency">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[2].checked ? '' : 'none'"
            [hidden]="diffDay < 14"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.weekFrequency' | translate}}
              </span>
              <span class="chartTitleUnit">times/week</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[2].checked ? '' : 'none'"
            [hidden]="diffDay < 14"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'weekFrequency'"
            ></div>
            <span class="setIn" *ngIf="row?.data.weekFrequency !== '--' && row?.data.weekFrequency >= 1">
              {{row?.data.weekFrequency | number:'1.0-0'}}
            </span>
            <span class="setIn" *ngIf="row?.data.weekFrequency !== '--' && row?.data.weekFrequency < 1">
              &lt; 1
            </span>
            <span class="setIn" *ngIf="row?.data.weekFrequency === '--'">
              {{row?.data.weekFrequency}}
            </span>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="avgTime">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[3].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.perCapita' | translate}} {{'Dashboard.MyActivity.timing' | translate}}
              </span>
              <span class="chartTitleUnit">time</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[3].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'avgTime'"
            ></div>
            <div class="setIn">
              <span
                [class.fixPlace]="row?.data.timeRegression === 0 || row?.data.avgTime === '-:--'"
              >
                {{row?.data.avgTime}}
              </span>
              <i
                class="icon-svg_web-icon_p3_017-up upArrow"
                *ngIf="row?.data.timeRegression > 0 && row?.data.avgTime !== '-:--'"
              ></i>
              <i
                class="icon-svg_web-icon_p3_018-down downArrow"
                *ngIf="row?.data.timeRegression < 0 && row?.data.avgTime !== '-:--'"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="avgFitTime">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[4].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.perCapita' | translate}} {{'conflict.benefitime' | translate}}
              </span>
              <span class="chartTitleUnit">time</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[4].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'avgFitTime'"
            ></div>
            <div class="setIn">
              <span
                [class.fixPlace]="row?.data.fitTimeRegression === 0 || row?.data.avgFitTime === '-:--'"
              >
                {{row?.data.avgFitTime}}
              </span>
              <i
                class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.data.fitTimeRegression > 0 && row?.data.avgFitTime !== '-:--'"
              ></i>
              <i
                class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.data.fitTimeRegression < 0 && row?.data.avgFitTime !== '-:--'"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="avgPai">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[5].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.perCapita' | translate}} {{'other.pai' | translate}}
              </span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[5].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'avgPai'"
            ></div>
            <div class="setIn">
              <span
                [class.fixPlace]="row?.data.paiRegression === 0"
              >
                {{row?.data.avgPai | number: '1.0-0'}}
              </span>
              <i
                class="icon-svg_web-icon_p3_017-up upArrow"
                *ngIf="row?.data.paiRegression > 0"
              ></i>
              <i
                class="icon-svg_web-icon_p3_018-down downArrow"
                *ngIf="row?.data.paiRegression < 0"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="avgCalories">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[6].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.perCapita' | translate}} {{'SH.calories' | translate}}
              </span>
              <span class="chartTitleUnit">cal</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[6].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.group ? row?.data.ratio : '0px'"
              *ngIf="sortCategory.group === 'avgCalories'"
            ></div>
            <div class="setIn">
              <span [class.fixPlace]="row?.data.caloriesRegression === 0" *ngIf="row?.data.avgCalories !== '--'">
                {{row?.data.avgCalories | number:'1.0-0'}}
              </span>
              <span [class.fixPlace]="row?.data.caloriesRegression === 0" *ngIf="row?.data.avgCalories === '--'">
                {{row?.data.avgCalories}}
              </span>
              <i class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.data.caloriesRegression > 0"></i>
              <i class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.data.caloriesRegression < 0"></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="HRZone">
          <mat-header-cell
            *matHeaderCellDef
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="groupTableTypeList.column[7].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">{{'SH.hrZone' | translate}}</span>
              <span class="chartTitleUnit">{{'SH.hrZone' | translate}}</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="groupTableTypeList.column[7].checked ? '' : 'none'"
          >
            <div style="width: 100%;" *ngIf="row?.data.HRZone !== '--'">
              <app-hrzone-chart
                [data]="row?.data.HRZone"
                [type]="'personalAnalysis'"
                *ngIf="!isLoading && !isRxjsLoading"
              ></app-hrzone-chart>
            </div>
            <span class="setIn" *ngIf="row?.data.HRZone === '--'">--</span>
          </mat-cell>
        </ng-container>
        <ng-container>
          <mat-header-row
            *matHeaderRowDef="groupHeaderRowDef"
          >
          </mat-header-row>
          <mat-row
            *matRowDef="let logRow; let j = index; columns: groupHeaderRowDef"
            (click)="handleClickGroup($event)"
            id="{{logRow?.gid}}"
          >
          </mat-row>
        </ng-container>
      </mat-table>
    </div>
    <div class="seeMoreLink" (click)="showAllData('group')" [hidden]="showAll.group">
      {{'Dashboard.TrainLive.more' | translate}}
    </div>
  </div>
  <div
    class="flexCol tableMenu"
    [style.top]="groupMenu.show ? groupMenu.y : null"
    [style.left]="groupMenu.show ? groupMenu.x : null"
    *ngIf="groupMenu.show"
    (mouseenter)="handleScrollEvent(true, 'menu')"
    (mouseleave)="handleScrollEvent(false, 'menu')"
    (touchstart)="handleScrollEvent(true, 'menu')"
    (touchend)="handleScrollEvent(false, 'menu')"
  >
    <div class="flexCol" style="padding: 15px 15px 0px 15px;">
      <span style="color: #656565; font-weight: bold;">{{'Dashboard.TrainLive.member' | translate}}</span>
      <div class="tableListSection">
        <div>
          <span
            class="listSpan"
            (click)="goMemberPage(member.id)"
            *ngFor="let member of groupPage.memberList"
          >
            <i
              class="icon-svg_web-icon_p1_059-lock lockIcon"
              *ngIf="!member.passPrivacy"
            ></i>
            {{ member.name }}
          </span>
        </div>
      </div>
    </div>
    <a target="_blank" class="tableMenuList" [href]="groupPage.info">
      {{'Dashboard.Group.GroupInfo.groupInfo' | translate}}
    </a>
    <a target="_blank" class="tableMenuList" [href]="groupPage.report">
      {{'Dashboard.SportReport.sportReport' | translate}}
    </a>
  </div>
  <div *ngIf="isPreviewMode && !isLoading" class="printMark">
    GPT Center
  </div>
  <div class="pageBreak" *ngIf="isPreviewMode"></div>
  <div
    class="flexCol"
    style="margin-bottom: 30px;"
    (scroll)="onWindowScroll()"
  >
    <div class="flexRow activity-title" style="justify-content: space-between;">
      <span class="ala-dashboard-title">
        {{'other.personalAnalysis' | translate}}
      </span>
      <div *ngIf="!isPreviewMode">
        <i
          class="icon-svg_web-icon_p1_001-setting"
          style="font-size: 25px; cursor: pointer;"
          (click)="showTableList('person')"
        ></i>
        <div
          class="flexCol tableMenu"
          style="position: absolute; right: 20px; padding: 10px; max-height: 300px; overflow-y: auto;"
          (mouseenter)="handleScrollEvent(true, 'table')"
          (mouseleave)="handleScrollEvent(false, 'table')"
          (touchstart)="handleScrollEvent(true, 'table')"
          (touchend)="handleScrollEvent(false, 'table')"
          *ngIf="showTableMenu.person"
        >
          <div *ngIf="+groupLevel <= 40">
            <span class="tableMenuTitle">{{'other.filter' | translate}} {{'Dashboard.Group.group' | translate}}</span>
            <div class="tableCheckbox" *ngFor="let list of personTableTypeList.filter">
              <mat-checkbox
                color="primary"
                value="{{list.id}}"
                [checked]="list.checked"
                (change)="changeTableType($event, 'person', 'filter')"
                [style.pointer-events]="tableTypeListOpt.tableCheckedNum.person.filter <= 1 && list.checked === true ? 'none' : ''"
                [style.color]="tableTypeListOpt.tableCheckedNum.person.filter <= 1 && list.checked === true ? '#ababab' : ''"
                *ngIf="+groupLevel <= 30 || list.id !== 0"
              >
                <span style="font-size: 14px">
                  {{ list.i18n }}
                </span>
              </mat-checkbox>
            </div>
          </div>
          <div>
            <div class="flexRow">
              <span class="tableMenuTitle">{{'other.fieldDisplay' | translate}}</span>
              <span
                style="font-size: 8px; margin-left: 5px;"
                [style.color]="tableTypeListOpt.tableCheckedNum.person.column >= tableTypeListOpt.max ? 'red' : '#ababab'"
              >
                ({{ 'other.upTo' | translate: {'number': tableTypeListOpt.max} }})
              </span>
            </div>
            <div class="tableCheckbox" *ngFor="let list of personTableTypeList.column">
              <mat-checkbox
                color="primary"
                value="{{list.id}}"
                [checked]="list.checked"
                (change)="changeTableType($event, 'person', 'column')"
                *ngIf="!(diffDay < 14 && list.id === 1)"
                [style.pointer-events]="
                  (tableTypeListOpt.tableCheckedNum.person.column >= tableTypeListOpt.max && list.checked === false)
                  || (tableTypeListOpt.tableCheckedNum.person.column <= tableTypeListOpt.min && list.checked === true)
                  ? 'none' : ''
                "
                [style.color]="
                  (tableTypeListOpt.tableCheckedNum.person.column >= tableTypeListOpt.max && list.checked === false)
                  || (tableTypeListOpt.tableCheckedNum.person.column <= tableTypeListOpt.min && list.checked === true)
                  ? '#ababab' : ''
                "
              >
                <span style="font-size: 14px">
                  {{ list.i18n }}
                </span>
              </mat-checkbox>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div style="margin-top: 10px;">
      <mat-table [dataSource]="tableData.display.person.data" matSort #personSortTable="matSort"  (matSortChange)="sortPersonData()">
        <ng-container matColumnDef="name">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="tableArrangement"
            style="justify-content: flex-start;"
            id="personName"
          >
            <span
              class="tableTitleWord"
              style="text-align: start;"
            >
              {{'Dashboard.Group.MyGroup.name' | translate}}
            </span>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent flexCol"
            style="align-items: flex-start; justify-content: center;"
            [style.color]="personalMenu.focusId === row?.userId ? '#157fcc': ''"
          >
            <span style="text-align: center;">{{row?.name}}</span>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="totalActivityNum">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[0].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">{{'other.totalActivity' | translate}}</span>
              <span class="chartTitleUnit">times</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[0].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'totalActivityNum'"
            ></div>
            <span class="setIn" *ngIf="row?.passPrivacy">{{row?.totalActivityNum}}</span>
            <i
              class="icon-svg_web-icon_p1_059-lock lockIcon setIn"
              *ngIf="!row?.passPrivacy"
            ></i>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="weekFrequency">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[1].checked ? '' : 'none'"
            [hidden]="diffDay < 14"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.weekFrequency' | translate}}
              </span>
              <span class="chartTitleUnit">times/week</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[1].checked ? '' : 'none'"
            [hidden]="diffDay < 14"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'weekFrequency'"
            ></div>
            <span class="setIn" *ngIf="row?.weekFrequency !== '--' && row?.weekFrequency >= 1">
              {{row?.weekFrequency | number:'1.0-0'}}
            </span>
            <span class="setIn" *ngIf="row?.weekFrequency !== '--' && row?.weekFrequency < 1">
              &lt; 1
            </span>
            <span class="setIn" *ngIf="row?.weekFrequency === '--' && row?.passPrivacy">
              {{row?.weekFrequency}}
            </span>
            <i
              class="icon-svg_web-icon_p1_059-lock lockIcon setIn "
              *ngIf="!row?.passPrivacy"
            ></i>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="totalTime">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[2].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="flexCenter tableTitleWord">
                {{'Dashboard.MyActivity.totalTime' | translate}}
              </span>
              <span class="chartTitleUnit">time</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[2].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'totalTime'"
            ></div>
            <div class="setIn">
              <span [class.fixPlace]="row?.timeRegression === 0" *ngIf="row?.passPrivacy">{{row?.totalTime}}</span>
              <i class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.timeRegression > 0"></i>
              <i class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.timeRegression < 0"></i>
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon fixPlace"
                *ngIf="!row?.passPrivacy"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="fitTime">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[3].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'conflict.benefitime' | translate}}
              </span>
              <span class="chartTitleUnit">time</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[3].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'fitTime'"
            ></div>
            <div class="setIn">
              <span [class.fixPlace]="row?.fitTimeRegression === 0" *ngIf="row?.passPrivacy">{{row?.fitTime}}</span>
              <i class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.fitTimeRegression > 0"></i>
              <i class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.fitTimeRegression < 0"></i>
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon fixPlace"
                *ngIf="!row?.passPrivacy"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="pai">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[4].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.pai' | translate}}
              </span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[4].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'pai'"
            ></div>
            <div class="setIn">
              <span [class.fixPlace]="row?.paiRegression === 0" *ngIf="row?.passPrivacy">{{row?.pai}}</span>
              <i class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.paiRegression > 0"></i>
              <i class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.paiRegression < 0"></i>
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon fixPlace"
                *ngIf="!row?.passPrivacy"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="totalCalories">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[5].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">
                {{'other.totalCalories' | translate}}
              </span>
              <span class="chartTitleUnit">cal</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[5].checked ? '' : 'none'"
          >
            <div
              class="visualizeData"
              [style.width]="sortStatus.person ? row?.ratio : '0px'"
              *ngIf="sortCategory.person === 'totalCalories'"
            ></div>
            <div class="setIn">
              <span [class.fixPlace]="row?.caloriesRegression === 0" *ngIf="row?.totalCalories !== '--'">
                {{row?.totalCalories | number:'1.0-0'}}
              </span>
              <span [class.fixPlace]="row?.caloriesRegression === 0" *ngIf="row?.totalCalories === '--' && row?.passPrivacy">
                {{row?.totalCalories}}
              </span>
              <i class="icon-svg_web-icon_p3_017-up upArrow" *ngIf="row?.caloriesRegression > 0"></i>
              <i class="icon-svg_web-icon_p3_018-down downArrow" *ngIf="row?.caloriesRegression < 0"></i>
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon fixPlace"
                *ngIf="!row?.passPrivacy"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="likeType">
          <mat-header-cell
            *matHeaderCellDef
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[6].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">{{'other.activityPreference' | translate}}</span>
              <span class="chartTitleUnit">type</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent tableAnalysisIcon"
            [style.display]="personTableTypeList.column[6].checked ? '' : 'none'"
          >
            <div class="setIn">
              <i [class]="row?.likeType[0]" *ngIf="row?.likeType.length > 0"></i>
              <i [class]="row?.likeType[1]" *ngIf="row?.likeType.length > 1"></i>
              <i [class]="row?.likeType[2]" *ngIf="row?.likeType.length > 2"></i>
              <span *ngIf="row?.likeType.length === 0 && row?.passPrivacy" style="font-size: 14px;">--</span>
              <i
                class="icon-svg_web-icon_p1_059-lock lockIcon"
                *ngIf="!row?.passPrivacy"
              ></i>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="HRZone">
          <mat-header-cell
            *matHeaderCellDef
            disableClear="true"
            class="flexCenter tableArrangement"
            [style.display]="personTableTypeList.column[7].checked ? '' : 'none'"
          >
            <div class="tableTitle">
              <span class="tableTitleWord">{{'SH.hrZone' | translate}}</span>
              <span class="chartTitleUnit">{{'SH.hrZone' | translate}}</span>
            </div>
          </mat-header-cell>
          <mat-cell
            *matCellDef="let row; let i = index;"
            class="tableArrangement tableContent"
            [style.display]="personTableTypeList.column[7].checked ? '' : 'none'"
          >
            <div style="width: 100%;" *ngIf="row?.HRZone !== '--'">
              <app-hrzone-chart
                [data]="row?.HRZone"
                [type]="'personalAnalysis'"
                *ngIf="!isLoading && !isRxjsLoading"
              ></app-hrzone-chart>
            </div>
            <span class="setIn" *ngIf="row?.HRZone === '--' && row?.passPrivacy">--</span>
            <i
              class="icon-svg_web-icon_p1_059-lock lockIcon setIn"
              *ngIf="!row?.passPrivacy"
            ></i>
          </mat-cell>
        </ng-container>
        <ng-container>
          <mat-header-row
            *matHeaderRowDef="personHeaderRowDef"
          >
          </mat-header-row>
          <mat-row
            *matRowDef="let logRow; let j = index; columns: personHeaderRowDef"
            (click)="handleClickMember($event)"
            id="{{logRow?.id}}"
          >
          </mat-row>
        </ng-container>
      </mat-table>
    </div>
    <div class="seeMoreLink" (click)="showAllData('person')" [hidden]="showAll.person">
      {{'Dashboard.TrainLive.more' | translate}}
    </div>
  </div>
  <div
    class="flexCol tableMenu"
    [style.top]="personalMenu.show ? personalMenu.y : null"
    [style.left]="personalMenu.show ? personalMenu.x : null"
    *ngIf="personalMenu.show"
    (mouseenter)="handleScrollEvent(true, 'menu')"
    (mouseleave)="handleScrollEvent(false, 'menu')"
    (touchstart)="handleScrollEvent(true, 'menu')"
    (touchend)="handleScrollEvent(false, 'menu')"
  >
    <div class="flexCol" style="padding: 15px 15px 0px 15px;">
      <span style="color: #656565; font-weight: bold;">{{'Dashboard.Group.MyGroup.groupList' | translate}}</span>
      <div class="tableListSection">
        <div>
          <span
            class="listSpan"
            (click)="goGroupPage(belongGroup.gid)"
            *ngFor="let belongGroup of personalPage.belongGroup"
          >
            {{ belongGroup.gName.groupName }}
          </span>
        </div>
      </div>
    </div>
    <a target="_blank" class="tableMenuList" [href]="personalPage.info">
      {{'Portal.basicInformation' | translate}}
    </a>
    <a target="_blank" class="tableMenuList" [href]="personalPage.report">
      {{'Dashboard.SportReport.sportReport' | translate}}
    </a>
  </div>
  <div *ngIf="isPreviewMode && !isLoading" class="printMark">
    GPT Center
  </div>
</ng-container>
